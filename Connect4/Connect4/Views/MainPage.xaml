<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:viewModels="clr-namespace:Connect4.ViewModels"
    xmlns:conv="clr-namespace:Connect4.Converters"
    x:Class="Connect4.Views.MainPage"
    Title="Connect 4">

    <!-- Resource dictionary containing custom converters -->
    <ContentPage.Resources>
        <ResourceDictionary>
            <!-- Converts a Board.Value into a cell color -->
            <conv:CellValueToSymbolConverter x:Key="CellValueToSymbolConverter" />
        </ResourceDictionary>
    </ContentPage.Resources>

    <Grid RowDefinitions="Auto,Auto,Auto,Auto" Padding="10">

        <!-- Displays game status message (e.g., current player's turn or winner) -->
        <Label 
            Text="{Binding StatusMessage}" 
            FontSize="24" 
            HorizontalOptions="Center"
            Grid.Row="0" 
            Margin="0,0,0,10"/>

        <!-- Row of arrow buttons to drop pieces into columns -->
        <Grid 
            x:Name="ArrowButtonsStack"
            Grid.Row="1" 
            ColumnDefinitions="*,*,*,*,*,*,*" 
            HeightRequest="50" 
            HorizontalOptions="Center"
            ColumnSpacing="0">

            <!-- One button per column, bound to DropPieceCommand with the column index -->
            <Button Grid.Column="0" Text="↓" Command="{Binding DropPieceCommand}" CommandParameter="0" FontSize="30" />
            <Button Grid.Column="1" Text="↓" Command="{Binding DropPieceCommand}" CommandParameter="1" FontSize="30"/>
            <Button Grid.Column="2" Text="↓" Command="{Binding DropPieceCommand}" CommandParameter="2" FontSize="30"/>
            <Button Grid.Column="3" Text="↓" Command="{Binding DropPieceCommand}" CommandParameter="3" FontSize="30"/>
            <Button Grid.Column="4" Text="↓" Command="{Binding DropPieceCommand}" CommandParameter="4" FontSize="30"/>
            <Button Grid.Column="5" Text="↓" Command="{Binding DropPieceCommand}" CommandParameter="5" FontSize="30"/>
            <Button Grid.Column="6" Text="↓" Command="{Binding DropPieceCommand}" CommandParameter="6" FontSize="30"/>
        </Grid>

        <!-- Game board container with black background to simulate the Connect 4 board frame -->
        <Grid Grid.Row="2"
              HorizontalOptions="CenterAndExpand"
              VerticalOptions="CenterAndExpand"
              Padding="10"
              Margin="0,0,0,20">

            <!-- Static black background underlay -->
            <BoxView x:Name="BoardBackground" Color="Black" />

            <!-- Grid where circular buttons are placed dynamically in code-behind -->
            <Grid x:Name="BoardGrid"
                  RowSpacing="4"
                  ColumnSpacing="4"
                  BackgroundColor="Black"
                  VerticalOptions="Center"
                  HorizontalOptions="CenterAndExpand" />
        </Grid>

        <!-- Button to reset the game, shown only when game is over -->
        <Button
            Text="Play Again"
            Command="{Binding ResetGameCommand}"
            Grid.Row="3"
            FontSize="20"
            BackgroundColor="DarkRed"
            TextColor="White"
            Padding="10"
            Margin="0,10,0,0"
            HorizontalOptions="Center"
            IsVisible="{Binding IsGameOver}" />

    </Grid>
</ContentPage>